<!-- 
    Document   : Тестовая страница для просмотра текущего состояния параметров пользователя
    Created on : Dec 17, 2016, 2:54:49 PM
    Author     : EMararu
-->  
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" 
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:security="http://www.springframework.org/security/tags" version="2.0">

    <jsp:directive.page contentType="text/html" pageEncoding="UTF-8"/>
    <jsp:include page="../../tile/page-body-header-user.jspx"/>
    
    <div>test1: <security:authorize access="isAuthenticated()">isAuthenticated()</security:authorize></div>
    <div>test2: <security:authorize access="isAnonymous()">isAnonymous()</security:authorize></div>    
    
    <div>
        <security:authorize access="isAuthenticated()">
            id=<security:authentication property="principal.id"/><br/>
            groupId=<security:authentication property="principal.groupId"/><br/>
            login=<security:authentication property="principal.login"/><br/>
            firstname=<security:authentication property="principal.firstname"/><br/>
            lastname=<security:authentication property="principal.lastname"/><br/>
            email=<security:authentication property="principal.email"/><br/>
            <img src="${requestScope.user_icon}"/><br/>
            
            ROLES:<br/>
            <security:authentication property="authorities" var="authorities"/>
            <c:forEach items="${authorities}" var="authority" varStatus="vs">
               ${authority.authority}<br/>
            </c:forEach>
               
            Check role:<br/>
            <security:authorize access="hasAuthority('admin')">admin<br/></security:authorize>
            <security:authorize access="hasAuthority('user')">user<br/></security:authorize>
            <security:authorize access="hasAuthority('comment')">comment<br/></security:authorize>
        </security:authorize>
    </div>
    

</jsp:root>
  
   
